### YamlMime:Course
title: Querying Data with Transact-SQL
metadata:
  title: 'Course 20761-C: Querying Data with Transact-SQL'
  description: 'Course 20761-C: Querying Data with Transact-SQL'
uid: course.20761
courseNumber: '20761-C'
hoursToComplete: 120
iconUrl: /media/learn/certification/course.svg
skillsGained:
- skill: 描述 SQL Server 的關鍵功能和元件。
- skill: 描述 T-SQL、集合和謂詞邏輯。
- skill: 撰寫單表 SELECT 語句。
- skill: 撰寫多表 SELECT 語句。
- skill: 撰寫具有過濾和排序功能的 SELECT 語句。
- skill: 描述 SQL Server 如何使用資料類型。
- skill: 撰寫 DML 語句。
- skill: 撰寫使用內置函數的查詢。
- skill: 撰寫匯總資料的查詢。
- skill: 撰寫子查詢。
- skill: 建立和實現視圖和表值函數。
- skill: 使用集合運算符組合查詢結果。
- skill: 撰寫使用窗口排名、偏移量和匯總函數的查詢。
- skill: 透過實現資料透視圖、取消透視圖、匯總和多維資料集來轉換資料。
- skill: 實作和實現存儲程式。
- skill: 向 T-SQL 代碼添加編程構造，例如變量、條件和循環。
learningPartnersLink: /learn/certifications/partners
locales:
- en
levels:
- intermediate
roles:
- database-administrator
products:
- sql-server
exams:
- uid: exam.70-761
summary: |-
  本課程旨在向學生介紹 Transact-SQL。它的設計方式是，可以將前三天作為一門課程教授給需要 SQL Server 課程中的其他課程知識的學生。第4天和第5天講授參加測驗 70-761 所需的其餘技能。

  #### 對象設定檔
  本課程的主要目的是使學生對所有 SQL Server 相關學科都使用的 Transact-SQL 語言有很好的了解，即資料庫管理、資料庫開發和商業智能。因此，本課程的主要目標受眾是：資料庫管理員、資料庫開發人員和 BI 專業人員。
prerequisitesSection: |-
  - Microsoft Windows 作業系統及其核心功能的基本知識。
  - 關聯式資料庫的工作知識。
outlineSection: |-
  ### 模組 1&#58; Microsoft SQL Server 導論
  本模組介紹 SQL Server、SQL Server 的版本（包括雲版本）以及如何使用 SQL Server Management Studio 連接到 SQL Server。
  #### 課程
  - SQL Server 的基本架構
  - SQL Server 版本
  - SQL Server Management Studio 入門


  #### 實驗室&#58; 使用 SQL Server 工具
  - 使用 SQL Server Management Studio
  - 建立和組織 T-SQL 腳本
  - 使用 Books Online

  完成本模組後，您將能夠&#58; 
  - 描述關係資料庫和 Transact-SQL 查詢。
  - 描述 SQL Server 的本地和基於雲的版本。
  - 描述如何使用 SQL Server Management Studio（SSMS）連接到 SQL Server 實例，瀏覽該實例中包含的資料庫以及如何使用包含 T-SQL 查詢的腳本檔案。


  ### 模組 2&#58; T-SQL 查詢導論
  本模組描述了 T-SQL 的元素及其在撰寫查詢中的作用。描述 SQL Server 中集合的用法。描述 SQL Server 中謂詞邏輯的使用。在 SELECT 語句中描述操作的邏輯順序。


  #### 課程
  - 介紹 T-SQL
  - 了解集合
  - 了解謂詞邏輯
  - 了解 SELECT 語句中的操作邏輯順序


  #### 實驗室&#58; T-SQL 查詢導論
  - 執行基本的 SELECT 語句
  - 執行使用謂詞篩選資料的查詢
  - 執行使用 ORDER BY 對資料進行排序的查詢

  完成本模組後，您將能夠&#58; 
  - 描述 T-SQL 在撰寫 SELECT 語句中的作用。
  - 描述 T-SQL 語言的元素以及哪些元素在撰寫查詢時將很有用。
  - 描述集合論的概念，這是關係型資料庫的數學基礎之一，並幫助您將其應用於如何考慮查詢 SQL Server
  - 描述謂詞邏輯並檢查其在查詢 SQL Server 中的應用。
  - 說明 SELECT 語句的元素，描述評估元素的順序，然後將此理解應用於撰寫查詢的實踐方法。


  ### 模組 3&#58; 撰寫 SELECT 查詢
  本模組介紹 SELECT 語句的基礎，重點是針對單一資料表的查詢。
  #### 課程
  - 撰寫簡單的 SELECT 語句
  - 使用 DISTINCT 消除重複
  - 使用資料行和資料表別名
  - 撰寫簡單的 CASE 表達式


  #### 實驗室&#58; 撰寫基本的 SELECT 語句
  - 撰寫簡單的 SELECT 語句
  - 使用 DISTINCT 消除重複
  - 使用資料行和資料表別名
  - 使用簡單的 CASE 表達式

  完成本模組後，您將能夠&#58; 
  - 描述 SELECT 語句的結構和格式，以及向查詢增加功能和可讀性的增強技術
  - 描述如何使用 DISTINCT 子句消除重複項
  - 描述資料行和資料表別名的使用
  - 了解和使用 CASE 表達式


  ### 模組 4&#58; 查詢多個資料表
  本模組描述如何撰寫將 Microsoft SQL Server 中多個來源的資料合併在一起的查詢。


  #### 課程
  - 了解 Joins
  - 使用 Inner Joins 進行查詢
  - 使用 Outer Joins 進行查詢
  - 使用 Cross Joins 和 Self Joins 進行查詢


  #### 實驗室&#58; 查詢多個資料表
  - 撰寫使用 Inner Joins 的查詢
  - 撰寫使用多表 Inner Joins 的查詢
  - 撰寫使用 Self-Joins 的查詢
  - 撰寫使用 Outer Joins 的查詢
  - 撰寫使用 Cross Joins 的查詢

  完成本模組後，您將能夠&#58; 
  - 解釋 SQL Server 中的聯接基礎 
  - 撰寫內部聯接查詢
  - 撰寫使用外部聯接的查詢 
  - 使用其他聯接類型


  ### 模組 5&#58; 排序和篩選資料
  本模組描述如何實現排序和篩選。
  #### 課程
  - 對資料進行排序
  - 使用 Predicates 篩選資料
  - 使用 TOP 和 OFFSET-FETCH 篩選資料
  - 使用未知值


  #### 實驗室&#58; 排序和篩選資料
  - 撰寫使用 WHERE 子句篩選資料的查詢
  - 撰寫使用 ORDER By 子句對資料進行排序的查詢
  - 撰寫使用 TOP 選項篩選資料的查詢
  - 寫寫使用 OFFSET-FETCH 子句篩選資料的查詢

  完成本模組後，您將能夠&#58; 
  - 說明如何在查詢中添加 ORDER BY 子句以控制查詢輸出中顯示的行順序
  - 說明如何構造 WHERE 子句以篩選出與謂詞不匹配的行。
  - 說明如何使用 TOP 選項限制 SELECT 子句中的行範圍。 
  - 說明如何使用 ORDER BY 子句的 OFFSET-FETCH 選項限制行範圍。
  - 說明三值邏輯如何解釋未知值和缺失值，SQL Server 如何使用 NULL 標記缺失值以及如何在查詢中測試 NULL。

  ### 模組 6&#58; 使用 SQL Server 資料類型
  本模組介紹了 SQL Server 用於存儲資料的資料類型。
  #### 課程
  - 介紹 SQL Server 資料類型
  - 使用字符資料
  - 使用日期和時間資料


  #### 實驗室&#58; 使用 SQL Server 資料類型
  - 撰寫返回日期和時間資料的查詢
  - 撰寫使用日期和時間函數的查詢
  - 撰寫返回字符資料的查詢
  - 撰寫返回字符功能的查詢

  完成本模組後，您將能夠&#58; 
  - 探索 SQL Server 用於存儲資料的許多資料類型以及如何在類型之間轉換資料類型
  - 說明基於 SQL Server 字符的資料類型、字符比較的工作方式以及一些可能對查詢有用的常用功能
  - 描述用於存儲時態資料的資料類型、如何輸入日期和時間，以便 SQL Server 正確解析它們，以及如何使用內置函數操作日期和時間。


  ### 模組 7&#58; 使用 DML 修改資料
  本模組描述如何建立 DML 查詢以及為什麼要建立。
  #### 課程
  - 將資料添加到表
  - 修改和移除資料
  - 生成自動列值


  #### 實驗室&#58; 使用 DML 修改資料
  - 使用 DML 插入記錄
  - 使用 DML 更新和移除記錄

  完成本模組後，您將能夠&#58; 
  - 使用 INSERT 和 SELECT INTO 語句
  - 使用UPDATE、MERGE、DELETE 和 TRUNCATE。


  ### 模組 8&#58; 使用內建功能
  本模組介紹了 SQL Server 中的其中一些內置函數。
  #### 課程
  - 使用內建函數撰寫查詢
  - 使用轉換函數
  - 使用邏輯函數
  - 使用函數以使用 NULL


  #### 實驗室&#58;使用內建函數
  - 撰寫使用轉換函數的查詢
  - 撰寫使用邏輯函數的查詢
  - 撰寫測試空屬性的查詢

  完成本模組後，您將能夠&#58; 
  - 描述 SQL Server 提供的函數的類型，然後重點是處理標量函數
  - 說明如何使用多個 SQL Server 函數在類型之間顯式轉換資料
  - 描述如何使用評估表達式並返回標量結果的邏輯函數。
  - 描述使用 NULL 的其他功能


  ### 模組 9&#58; 分組和匯總資料
  本模組描述如何使用聚合函數。
  #### 課程
  - 使用聚合函數
  - 使用 GROUP BY 子句
  - 使用 HAVING 篩選群組


  #### 實驗室&#58; 分組和匯總資料
  - 撰寫使用GROUP BY子句的查詢
  - 撰寫使用聚合函數的查詢
  - 撰寫使用不同聚合函數的查詢
  - 撰寫使用 HAVING 子句篩選組的查詢

  完成本模組後，您將能夠&#58; 
  - 描述 SQL Server 中的內置聚合函數，並使用此函數撰寫查詢。
  - 撰寫使用 GROUP By 子句分隔行的查詢。
  - 撰寫使用 HAVING 子句篩選組的查詢。


  ### 模組 10&#58; 使用子查詢
  本模組描述了幾種類型的子查詢以及如何與何時使用它們。
  #### 課程
  - 撰寫自包含子查詢
  - 撰寫相關子查詢
  - 將 EXISTS 謂詞與子查詢一起使用


  #### 實驗室&#58; 使用子查詢
  - 撰寫使用自包含子查詢的查詢
  - 撰寫使用標量和多結果子查詢的查詢
  - 撰寫使用相關子查詢和 EXISTS 子句的查詢

  完成本模組後，您將能夠&#58; 
  - 描述在 SELECT 語句中何處可以使用子查詢。
  - 撰寫在 SELECT 語句中使用相關子查詢的查詢
  - 撰寫在 WHERE 子句中使用 EXISTS 謂詞的查詢，以測試是否存在合格行
  - 使用 EXISTS 謂詞可以有效檢查子查詢中是否存在列。


  ### 模組 11&#58; 使用資料表運算式
  在本課程的前面，您學習了如何使用子查詢作為將結果返回給外部調用查詢的表達式。像子查詢一樣，資料表運算式是查詢運算式，但是資料表運算式透過允許您命名它們並使用它們的結果來擴展此概念，就像使用任何有效關係表中的資料一樣。Microsoft SQL Server 支援四種類型的資料表運算式&#58;派生表、通用資料表運算式（CTE）、視圖和內聯表值函數（TVF）。在本模組中，您將學習使用這些形式的資料表運算式，並學習如何使用它們來幫助建立用於撰寫查詢的模組化方法。
  #### 課程
  - 使用視圖
  - 使用內聯資料表值函數
  - 使用衍生資料表
  - 使用通用資料表運算式


  #### 實驗室&#58; 使用資料表運算式
  - 撰寫使用視圖的查詢
  - 撰寫使用派生表的查詢
  - 撰寫使用通用資料表運算式（CTE）的查詢
  - 撰寫使用內聯表值表達式（TVF）的查詢

  完成本模組後，您將能夠&#58; 
  - 撰寫查詢以返回視圖結果。
  - 使用 CREATE FUNCTION 語句建立簡單的嵌入式 TVF。
  - 撰寫查詢，以從派生表中建立和檢索結果。
  - 撰寫建立 CTE 並從資料表運算式返回結果的查詢。


  ### 模組 12&#58; 使用集合運算符
  本模組介紹如何使用集合運算符UNION、INTERSECT 和 EXCEPT 比較兩個輸入集合之間的行。
  #### 課程
  - 使用 UNION 運算符撰寫查詢
  - 使用 EXCEPT 和 INTERSECT
  - 使用 APPLY


  #### 實驗室&#58; 使用集合運算符
  - 撰寫使用 UNION Set 運算符和 UNION ALL 的查詢
  - 撰寫使用 CROSS APPLY 和 OUTER APPLY 運算符的查詢
  - 撰寫使用 EXCEPT 和 INTERSECT 運算符的查詢

  完成本模組後，學生將能夠&#58;
  - 撰寫使用 UNION 組合輸入集的查詢。
  - 撰寫使用 UNION ALL 組合輸入集的查詢
  - 撰寫使用 EXCEPT 運算符的查詢，只返回一組中的行，而不返回另一組的行。
  - 撰寫使用 INTERSECT 運算符的查詢，僅返回兩個集合中都存在的行
  - 使用 CROSS APPLY 運算符撰寫查詢。
  - 使用 OUTER APPLY 運算符撰寫查詢


  ### 模組 13&#58; 使用 Windows 排名、偏移量和聚合函數
  本模組描述了使用窗口函數的好處。將窗口函數限制為 OVER 子句中定義的行，包括分區和框架。撰寫使用窗口函數對行窗口進行操作並返回排名、匯總和偏移比較結果的查詢。
  #### 課程
  - 使用 OVER 建立 Windows
  - 探索窗口函數


  #### 實驗室&#58; 使用 Windows排名、偏移量和聚合函數
  - 撰寫使用排名函數的查詢
  - 撰寫使用偏移函數的查詢
  - 撰寫使用窗口聚合函數的查詢

  完成本模組後，學生將能夠&#58;
  - 描述用於定義窗口的 T-SQL 元件以及它們之間的關係。
  - 撰寫使用 OVER 子句的查詢，並透過分區、排序和制訂框架來定義窗口
  - 撰寫使用窗口聚合函數的查詢。
  - 撰寫使用窗口排名函數的查詢。
  - 撰寫使用窗口偏移量函數的查詢


  ### 模組 14&#58; 資料透視和分組
  本模組描述了撰寫對結果集進行透視和不透視處理的查詢。撰寫使用分組集指定多個分組的查詢
  #### 課程
  - 使用 PIVOT 和 UNPIVOT 撰寫查詢
  - 使用分組集


  #### 實驗室&#58; 資料透視和分組集
  - 撰寫使用 PIVOT 運算符的查詢
  - 撰寫使用 UNPIVOT 運算符的查詢
  - 撰寫使用 GROUPING SETS CUBE 和 ROLLUP 子句的查詢

  完成本模組後，學生將能夠&#58;
  - 描述如何在 T-SQL 查詢中使用資料透視。
  - 撰寫使用 PIVOT 運算符的查詢，以將資料從行旋轉透視到列。
  - 撰寫使用 UNPIVOT 運算符的查詢，以取消資料從列旋轉透視到行。
  - 撰寫使用 GROUPING SETS 子句的查詢。
  - 撰寫使用 ROLLUP 和 CUBE 的查詢。
  - 撰寫使用 GROUPING_ID 函數的查詢。


  ### 模組 15&#58; 執行存儲程式
  本模組描述如何透過執行存儲程式來返回結果。將參數傳遞給程式。建立封裝 SELECT 語句的簡單存儲程式。使用 EXEC 和 sp_executesql 構造和執行動態 SQL。
  #### 課程
  - 使用存儲程式查詢資料
  - 將參數傳遞給存儲程式
  - 建立簡單的存儲程式
  - 使用動態SQL


  #### 實驗室&#58; 執行存儲程式
  - 使用 EXECUTE 語句調用存儲程式
  - 將參數傳遞給存儲程式
  - 執行系統存儲程式

  完成本模組後，學生將能夠&#58;
  - 描述存儲程式及其用法。
  - 撰寫執行存儲程式以返回資料的 T-SQL 語句。
  - 撰寫將輸入參數傳遞給存儲程式的 EXECUTE 語句。
  - 撰寫準備輸出參數並執行存儲程式的 T-SQL 批處理。
  - 使用 CREATE PROCEDURE 語句撰寫存儲程式。
  - 建立一個接受輸入參數的存儲程式。
  - 描述如何動態構建 T-SQL。
  - 撰寫使用動態 SQL 的查詢。


  ### 模組 16&#58; 使用 T-SQL 編程
  本模組描述如何使用編程元素來增強 T-SQL 代碼。
  #### 課程
  - T-SQL 編程元素
  - 控制程式流程


  #### 實驗室&#58; 使用 T-SQL 進行編程
  - 聲明變量和定界批次
  - 使用流量控制元素
  - 在動態 SQL 語句中使用變量
  - 使用同義詞

  完成本模組後，學生將能夠&#58;
  - 描述 Microsoft SQL Server 如何將語句集合視為批處理。
  - 建立並提交一批 T-SQL 代碼以供 SQL Server 執行。
  - 描述 SQL Server 如何將臨時對象存儲為變量。
  - 撰寫聲明和分配變量的代碼。
  - 建立和調用同義詞
  - 描述 T-SQL 中的流程控制元素。
  - 使用 IF  ELSE 塊撰寫 T-SQL 代碼。
  - 撰寫使用 WHILE 的 T-SQL 代碼。


  ### 模組 17&#58; 實作錯誤處理
  本模組介紹了 T-SQ L的錯誤處理。
  #### 課程
  - 實作 T-SQL 錯誤處理
  - 實作結構化異常處理


  #### 實驗室&#58; 實作錯誤處理
  - 使用 TRY / CATCH 重定向錯誤
  - 使用 THROW 將錯誤消息傳遞回客戶端

  完成本模組後，學生將能夠&#58;
  - 實現 T-SQL 錯誤處理。
  - 實作結構化異常處理。


  ### 模組 18&#58; 實作事務
  本模組描述如何實作事務。
  #### 課程
  - 事務和資料庫引擎
  - 控制事務


  #### 實驗室&#58; 實作事務
  - 使用 BEGIN、COMMIT 和 ROLLBACK 控制事務
  - 向 CATCH 塊添加錯誤處理

  完成本模組後，學生將能夠&#58;
  - 描述事務以及批次和事務之間的差異。
  - 描述批次以及 SQL Server 如何處理它們。
  - 使用事務控制語言（TCL）語句建立和管理事務。
  - 使用 SET XACT_ABORT 定義 SQL Server 對 TRY / CATCH 塊之外的事務的處理。

